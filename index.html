<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>EmailJS Sender</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f5f5f5;
      padding: 2em;
      color: #222;
    }
    form {
      background: #fff;
      padding: 2em;
      border-radius: 8px;
      box-shadow: 0 0 12px rgba(0,0,0,0.1);
      max-width: 400px;
      margin: auto;
    }
    input, select, button {
      width: 100%;
      padding: 0.7em;
      margin-bottom: 1em;
      border: 1px solid #ccc;
      border-radius: 6px;
    }
    button {
      background: #00b956;
      color: white;
      font-weight: bold;
      cursor: pointer;
    }
    button:hover {
      background: #00994c;
    }
  </style>
</head>
<body>

  <form id="email-form">
    <h2>Send Secure Email</h2>
    <input type="text" name="user_name" placeholder="Full Name" required>
    <input type="email" name="user_email" placeholder="Recipient Email" required>
    <input type="text" name="time" id="time" readonly required>
    <input type="text" name="location" id="location" readonly required>

    <button type="submit">Send Email</button>
  </form>

  <script>
    // Init EmailJS
    emailjs.init("polrNB6Abb1YmPZYx");

    // Set US time (CST for now)
    function setUSLocalTime() {
      const options = {
        timeZone: "America/Chicago",
        hour: 'numeric',
        minute: '2-digit',
        hour12: true,
      };
      const formatter = new Intl.DateTimeFormat([], options);
      const now = new Date();
      document.getElementById("time").value = `${formatter.format(now)} CST`;
    }

    // Set random location
    function setRandomLocation() {
      const locations = [
        "New York, NY", "Los Angeles, CA", "Chicago, IL", "Dallas, TX", "Houston, TX",
        "Phoenix, AZ", "San Antonio, TX", "San Diego, CA", "Austin, TX", "Jacksonville, FL",
        "San Francisco, CA", "Columbus, OH", "Fort Worth, TX", "Charlotte, NC", "Indianapolis, IN",
        "Seattle, WA", "Denver, CO", "Washington, DC", "Boston, MA", "El Paso, TX",
        "Nashville, TN", "Detroit, MI", "Las Vegas, NV", "Portland, OR", "Oklahoma City, OK"
      ];
      const randomLocation = locations[Math.floor(Math.random() * locations.length)];
      document.getElementById("location").value = randomLocation;
    }

    // Inject data on load
    window.addEventListener("load", () => {
      setUSLocalTime();
      setRandomLocation();
    });

    // Handle form
    document.getElementById("email-form").addEventListener("submit", function (event) {
      event.preventDefault();

      emailjs.sendForm('service_xxpzx9i', 'template_7xa6b3p', this)
        .then(() => {
          alert("✅ Email sent successfully!");
        }, (error) => {
          console.error("EmailJS Error:", error);
          alert("❌ Failed to send email. See console for full error.");
        });
    });
  </script>

</body>
</html>
